import"../chunks/CWj6FrbW.js";import{i as Ve}from"../chunks/Bykrahq8.js";import{ah as We,at as Xe,P as Ze,au as qe,av as ea,x as aa,p as ra,s as v,g as e,aw as H,o as ta,f as u,h as sa,b as l,c as ia,m as B,t as m,$ as oa,j as t,r as s,d as _,i as M,e as ce,ax as J,a as L,n as na,ay as la,az as da}from"../chunks/C1cF_f_f.js";import{i as w}from"../chunks/oCXtbbpy.js";import{e as Se,i as va}from"../chunks/sx0AX0zF.js";import{s as E,r as $e,b as Fe,a as ua}from"../chunks/CGMAZzXY.js";import{p as ca}from"../chunks/Bfc47y5P.js";import{s as fa,a as ma}from"../chunks/BhgOVFHs.js";import{s as _a,g as fe}from"../chunks/C9t7Hmsj.js";import{a as ba,o as pa,e as ga}from"../chunks/D1b5UXiN.js";function Ie(r,d,N=!1){if(r.multiple){if(d==null)return;if(!Ze(d))return qe();for(var b of r.options)b.selected=d.includes(K(b));return}for(b of r.options){var c=K(b);if(ea(c,d)){b.selected=!0;return}}(!N||d!==void 0)&&(r.selectedIndex=-1)}function ha(r){var d=new MutationObserver(()=>{Ie(r,r.__value)});d.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),aa(()=>{d.disconnect()})}function xa(r,d,N=d){var b=!0;We(r,"change",c=>{var T=c?"[selected]":":checked",p;if(r.multiple)p=[].map.call(r.querySelectorAll(T),K);else{var k=r.querySelector(T)??r.querySelector("option:not([disabled])");p=k&&K(k)}N(p)}),Xe(()=>{var c=d();if(Ie(r,c,b),b&&c===void 0){var T=r.querySelector(":checked");T!==null&&(c=K(T),N(c))}r.__value=c,b=!1}),ha(r)}function K(r){return"__value"in r?r.__value:r.value}const ya=()=>{const r=_a;return{page:{subscribe:r.page.subscribe},navigating:{subscribe:r.navigating.subscribe},updated:r.updated}},wa={subscribe(r){return ya().page.subscribe(r)}};var ka=u('<div class="card"><h2 class="text-lg font-bold mb-4">ğŸ“± Form Not Available Offline</h2> <p class="text-red-600 mb-4"> </p> <div style="background: #fef3c7; padding: 1rem; border-radius: 0.5rem; margin-bottom: 1rem;"><p class="text-yellow-800"><strong>ğŸ’¡ To use this form offline:</strong><br/> 1. Connect to the internet<br/> 2. Go back to the forms list<br/> 3. Click the "ğŸ“¥ Download" button next to this form<br/> 4. You can then fill it out without internet</p></div> <button class="btn">â† Back to Forms</button></div>'),Sa=u('<div class="card" style="background: #d1fae5; border-left: 4px solid #10b981;"><p class="text-green-600 font-bold"> </p></div>'),$a=u('<div class="card" style="background: #fee2e2; border-left: 4px solid #ef4444;"><p class="text-red-600 font-bold"> </p></div>'),Fa=u('<span style="color: #ef4444;">*</span>'),Ia=u('<input class="input" placeholder="Enter your answer"/>'),Ta=u('<textarea class="input" placeholder="Enter your answer" rows="4"></textarea>'),Aa=u("<option> </option>"),Da=u('<select class="input"><option>Select an option</option><!></select>'),Ma=u('<div style="display: flex; align-items: center; gap: 0.5rem;"><input type="checkbox"/> <label>Yes</label></div>'),Pa=u('<div class="card"><div class="form-group"><label class="form-label"> <!></label> <!></div></div>'),ja=u(`<div class="card"><div style="display: flex; justify-content: space-between; align-items: center;"><div><h1 class="text-xl font-bold"> </h1> <p class="text-gray-600"> </p></div> <button class="btn-secondary" style="width: auto; padding: 0.5rem 1rem;">â† Back</button></div></div> <!> <!> <form><!> <div class="card"><button type="submit" class="btn"> </button> <p class="text-gray-600 text-center mt-4">ğŸ’¾ Your data will be saved locally and synced when you're online</p></div></form>`,1),Ba=u('<div class="card"><p class="text-gray-600">Loading form...</p></div>'),Ea=u('<div class="container"><!></div>');function Ja(r,d){ra(d,!1);const[N,b]=ma(),c=()=>fa(wa,"$page",N);let T=null,p=B(null),k=B([]),o=B({}),S=B(!1),U=B(""),h=B(""),Z="",q=B(!1);ba.subscribe(n=>{T=n.user,T||fe("/")}),pa.subscribe(n=>{var A;const i=n.forms||[];Z=c().params.id,v(p,i.find(D=>D.id===Z)),v(k,((A=e(p))==null?void 0:A.questions)||[]),v(q,!!e(p)),!e(q)&&Z?v(h,"This form is not available offline. Please download it first when you have internet connection."):v(h,""),e(k).forEach(D=>{D.id in e(o)||H(o,e(o)[D.id]="")})}),ta(()=>{if(!c().params.id){v(h,"Form ID not found");return}});async function Te(){const n=e(k).filter(i=>i.required&&(!e(o)[i.id]||e(o)[i.id].toString().trim()===""));if(n.length>0){v(h,`Please answer all required questions: ${n.map(i=>i.questionText).join(", ")}`);return}v(S,!0),v(h,""),v(U,"");try{const i=ga(e(p).id,e(o));v(U,"Form submitted successfully! Data saved locally and will sync when online."),setTimeout(()=>{fe("/forms")},2e3)}catch(i){v(h,"Failed to save submission: "+i.message)}v(S,!1)}function me(){fe("/forms")}function V(n){switch(n.type){case"text":case"email":case"number":return"input";case"textarea":return"textarea";case"select":case"radio":return"select";case"checkbox":return"checkbox";default:return"input"}}function Ae(n){switch(n){case"email":return"email";case"number":return"number";default:return"text"}}Ve();var ee=Ea();sa(n=>{m(()=>{var i;return oa.title=`${((i=e(p))==null?void 0:i.formName)||"Form"} - Aid Platform Mobile`})});var De=t(ee);{var Me=n=>{var i=ka(),A=_(t(i),2),D=t(A,!0);s(A);var ae=_(A,4);s(i),m(()=>M(D,e(h))),ce("click",ae,me),l(n,i)},Pe=n=>{var i=J(),A=L(i);{var D=O=>{var W=ja(),re=L(W),_e=t(re),te=t(_e),se=t(te),je=t(se,!0);s(se);var be=_(se,2),Be=t(be);s(be),s(te);var Ee=_(te,2);s(_e),s(re);var pe=_(re,2);{var Ne=g=>{var a=Sa(),P=t(a),j=t(P);s(P),s(a),m(()=>M(j,`âœ… ${e(U)??""}`)),l(g,a)};w(pe,g=>{e(U)&&g(Ne)})}var ge=_(pe,2);{var Oe=g=>{var a=$a(),P=t(a),j=t(P);s(P),s(a),m(()=>M(j,`âŒ ${e(h)??""}`)),l(g,a)};w(ge,g=>{e(h)&&g(Oe)})}var ie=_(ge,2),he=t(ie);Se(he,3,()=>e(k),g=>g.id,(g,a,P)=>{var j=Pa(),ye=t(j),X=t(ye),we=t(X),Ce=_(we);{var Le=x=>{var f=Fa();l(x,f)};w(Ce,x=>{e(a).required&&x(Le)})}s(X);var ze=_(X,2);{var Ge=x=>{var f=Ia();$e(f),m(z=>{E(f,"id",`q_${e(a).id??""}`),E(f,"type",z),f.required=e(a).required,f.disabled=e(S)},[()=>Ae(e(a).type)]),Fe(f,()=>e(o)[e(a).id],z=>H(o,e(o)[e(a).id]=z)),l(x,f)},Qe=x=>{var f=J(),z=L(f);{var Re=Y=>{var $=Ta();la($),m(()=>{E($,"id",`q_${e(a).id??""}`),$.required=e(a).required,$.disabled=e(S)}),Fe($,()=>e(o)[e(a).id],ne=>H(o,e(o)[e(a).id]=ne)),l(Y,$)},He=Y=>{var $=J(),ne=L($);{var Je=C=>{var y=Da();m(()=>{e(o),da(()=>{e(a),e(S)})});var G=t(y);G.value=G.__value="";var le=_(G);{var Q=F=>{var I=J(),de=L(I);Se(de,1,()=>e(a).options,va,(ve,ue)=>{var R=Aa(),Ue=t(R,!0);s(R);var ke={};m(()=>{M(Ue,e(ue)),ke!==(ke=e(ue))&&(R.value=(R.__value=e(ue))??"")}),l(ve,R)}),l(F,I)};w(le,F=>{e(a).options&&F(Q)})}s(y),m(()=>{E(y,"id",`q_${e(a).id??""}`),y.required=e(a).required,y.disabled=e(S)}),xa(y,()=>e(o)[e(a).id],F=>H(o,e(o)[e(a).id]=F)),l(C,y)},Ke=C=>{var y=J(),G=L(y);{var le=Q=>{var F=Ma(),I=t(F);$e(I);var de=_(I,2);s(F),m(()=>{E(I,"id",`q_${e(a).id??""}`),I.required=e(a).required,I.disabled=e(S),E(de,"for",`q_${e(a).id??""}`)}),ua(I,()=>e(o)[e(a).id],ve=>H(o,e(o)[e(a).id]=ve)),l(Q,F)};w(G,Q=>{V(e(a))==="checkbox"&&Q(le)},!0)}l(C,y)};w(ne,C=>{V(e(a))==="select"?C(Je):C(Ke,!1)},!0)}l(Y,$)};w(z,Y=>{V(e(a))==="textarea"?Y(Re):Y(He,!1)},!0)}l(x,f)};w(ze,x=>{V(e(a))==="input"?x(Ge):x(Qe,!1)})}s(ye),s(j),m(()=>{E(X,"for",`q_${e(a).id??""}`),M(we,`${e(P)+1}. ${e(a).questionText??""} `)}),l(g,j)});var xe=_(he,2),oe=t(xe),Ye=t(oe,!0);s(oe),na(2),s(xe),s(ie),m(()=>{M(je,e(p).formName),M(Be,`${e(k).length??""} questions`),oe.disabled=e(S)||e(k).length===0,M(Ye,e(S)?"Submitting...":"ğŸ“¤ Submit Form")}),ce("click",Ee,me),ce("submit",ie,ca(Te)),l(O,W)},ae=O=>{var W=Ba();l(O,W)};w(A,O=>{e(p)?O(D):O(ae,!1)},!0)}l(n,i)};w(De,n=>{e(h)&&!e(q)?n(Me):n(Pe,!1)})}s(ee),l(r,ee),ia(),b()}export{Ja as component};
